---
title: "Template Title"
author: "Your Name"
date: "`r format(Sys.time(), '%d %B %Y')`"
output: 
  word_document:
      reference_docx: "K:/TEU/TEU Guides/TEU_DocStyle_2020.dotx"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(include=TRUE, echo=FALSE, warning=FALSE)

library(kableExtra)
library(knitr)
library(yaml)
library(here)

# Specify the markdown format for knitr tables, otherwise they're not compatible with kableExtra
options(knitr.kable.NA='', knitr.table.format = "markdown")
# Set the root directory to the project directory (otherwise knitr works in the directory of the Rmd file by default)
knitr::opts_knit$set(root.dir = here())

# Load the project config file for filepaths etc
config = yaml.load_file(here("./config.yml"))


```

This R Markdown file is not intended to produce a particularly interesting output.
It is just a convenient way to present code that can be run in chunks, with documentation.

# For the HTN analysis, we need to run the hypertension rubric

```{r}

# First, use the mapping Excel to identify antihypertensive medications by code
source(paste0(config$scripts$processing,  "HTNMedicationCodes.R"))

# Then, apply the rubric
source(paste0(config$scripts$processing,  "MedGroupCategorisation.R"))

```

# Then we want to pull all the relevant data together and save it ready for analysis

```{r}

source(paste0(config$scripts$processing,  "HTNraw.R"))

```

# Finally, apply the relevant exclusion criteria

This script also produces the exclusion flowchart

```{r}

source(paste0(config$scripts$processing,  "Neo_exclusions.R"))

```