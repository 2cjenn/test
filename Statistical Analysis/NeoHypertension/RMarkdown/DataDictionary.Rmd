---
title: "Data Dictionary"
author: "Jennifer Collister"
date: "17/04/2020"
output: 
  word_document:
      reference_docx: "K:/TEU/APOE on Dementia/RMarkdownLandscape.docx"
---

```{r setup, include=FALSE, echo=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(kableExtra)
library(knitr)
library(dataMeta)
library(readxl)
library(devtools)
library(dplyr)

install_local("K:\\TEU\\Code Repository\\dataMetaFork")

data <- readRDS(file="K:\\TEU\\APOE on Dementia\\Data Management\\R_Dataframes_TLA\\38358\\Organised\\Hypertension\\Neo\\HTN_excl.rds")

dictpath <- "K:\\TEU\\APOE on Dementia\\Data Management\\DataDictionary\\DataDictionary.xlsx"

```

# Data dictionary


```{r datameta, include=TRUE, echo=FALSE}

core <- data[,c("ID", "evidenceHTN_", "aware_", "treated_", "controlled_", "age", "agegrp", "gender", "ethnicity", 
          "BMIcat", "Smo_Status", "weekly_alcunits", "weekly_alccat", "alc_heavyuse_", "PhA_METsWkAllAct", "METs_over150",
          "townsend_quint", "income", "employment", "ISCED", "BirthCountryIncomeLevel", "countryResidence", "BowelCancerScreening",
          "HTNdx_durcat", "antiHTNmedsno",  "FamilyHist_CVD_", 
          "comorbNumber_", "recdate")]

core_linker <- build_linker(core, master_dictionary=dictpath)

core_dict <- build_dict(my.data=core, linker=core_linker, option_description=NULL, prompt_varopts=FALSE, na.rm=TRUE)

kable(core_dict)

core_desc <- "The variables required for the core analysis"

coredata <- incorporate_attr(my.data=core, data.dictionary=core_dict, main_string=core_desc)

```







